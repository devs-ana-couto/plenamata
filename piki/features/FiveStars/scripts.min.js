!function(s){var t={configure:function(e,r){return this.each(function(){var a={$:s(this),self:this,locked:!1};a.type=a.$.attr("type"),a.ID=a.$.attr("rel"),a.stars=a.$.find(".star"),a.scoreMedia=a.$.attr("score-media"),a.userScore=a.$.attr("user-score"),a.status=a.$.find("em").first(),a.statusNumber=s("strong",a.status).first(),a.statusPlural=s("span",a.status).first(),a.successMessage=a.$.attr("data-success-message"),a.$.data("fiveStars",a),void 0!==r&&t[r].apply(a.$,[a,e])})},setScores:function(s,t){return this.each(function(){s.stars.removeClass("active");for(var e=1;e<=t;e++)s.stars.eq(e-1).addClass("active")})},mouseover:function(s,t){return this.each(function(){s.$.fiveStars("setScores",t.score),s.statusNumber.text(t.score),t.score>1?s.statusPlural.show():s.statusPlural.hide(),s.status.stop().fadeIn(200)})},click:function(e,r){return this.each(function(){s.fn.pikiLoader(),s.ajax({url:Piki.ajaxurl,type:"POST",dataType:"JSON",data:{action:"five_stars_vote",ID:e.ID,type:e.type,score:r.score}}).done(function(r){e.userScore=r.user_score,e.scoreMedia=r.total,e.locked=!0,e.$.removeClass("free").addClass("locked"),e.status.html(e.successMessage).stop().show(),t.setScores.apply(e.$,[e,e.userScore]),s.fn.pikiLoader("close")}).fail(function(t,e){s.fn.pikiLoader("close"),s.fn.pikiAlert("Request failed: "+e)})})},mouseout:function(s,e){return this.each(function(){var e=s.userScore>0?s.userScore:s.scoreMedia;t.setScores.apply(s.$,[s,e]),s.status.stop().fadeOut()})}};s.fn.fiveStars=function(e,r){var a=s(this).data("fiveStars");return void 0===a?t.configure.apply(s(this),[r,e]):a.locked?(a.status.show(),this):t[e].apply(s(this),[a,r])},s(function(){s("body").on("mouseover click mouseout",".five-stars-box .star",function(t){void 0===this.$&&(this.$=s(this),this.target=this.$.parents(".five-stars-box").first(),this.score=this.$.attr("score")),this.target.fiveStars(t.type,this)})})}(jQuery);