PikiFields.add("window.startFileWP"),function($){window.startFileWP=function(){$(".linha-field.ftype-filewp").fileWpField()},$.fn.fileWpField=function(method){var pluginArgs=arguments;return this.each(function(){var field=this,$this=$(this);this.configure=function(){var t=this;t.target=$("input.filewp-ids",$this).first(),t.select=$("input.filewp-select-button",$this).first(),t.edit=$("input.filewp-edit-button",$this).first(),t.remove=$("input.filewp-remove-button",$this).first(),t.label=$("input.filewp-upload-label",$this).first().val(),t.thumbs=$("div.filewp-media-thumbs",$this).first(),t.status=$("div.filewp-media-status",$this).first(),t.multiple=void 0!==$this.attr("--multiple")&&"on"===$this.attr("--multiple"),t.thumbs.on("click","a.remove",function(e){e.preventDefault(),t.removeFileItem($(this),t)}),t.multiple&&(t.thumbs.sortable({items:"div.thumbnail",stop:function(e,i){t.alignValues()}}),t.thumbs.disableSelection()),t.wpmedia=wp.media.frames.customHeader=wp.media({title:t.select.val(),button:{text:t.select.val()},multiple:void 0!==$this.attr("--multiple")&&"on"===$this.attr("--multiple")}),t.wpmedia.on("select",function(){var e=t.wpmedia.state().get("selection");t.returnFile(e)}),t.select.on("click",function(e){e.preventDefault(),t.wpmedia.open()}),t.edit.on("click",function(e){e.preventDefault(),t.wpmedia.open()}),t.remove.on("click",function(e){e.preventDefault(),t.removeValues(),t.remove.hide(),t.edit.hide(),t.select.show(),t.thumbs.fadeOut()});t.thumbs.children("div.thumbnail").length&&t.thumbs.show(),t.ready=!0},this.alignValues=function(){var t=[];this.thumbs.children().each(function(){t.push($(this).attr("rel"))}),this.target.val(t.join(","))},this.returnFile=function(t){this.remove.show(),this.multiple?(field.edit.hide(),field.select.show()):(this.removeValues(),field.edit.show(),field.select.hide());var e=field.target.val();e=""===e?[]:e.split(","),t.map(function(t){t=t.toJSON(),e.push(t.id);var i=$('<div class="thumbnail" rel="'+t.id+'"></div>');i.html('<img src="'+t.icon+'" alt="'+t.title+'" /><a rel="'+t.id+'" class="action remove" title="Remover">Remover arquivo</a>'),field.thumbs.stop().fadeIn(),i.hide().prependTo(field.thumbs).fadeIn(400)}),field.target.val(e.join(","))},this.removeValues=function(){this.thumbs.length&&this.thumbs.stop().hide().html(""),this.target.val("")},this.removeFileItem=function(t,e){var i=t.attr("rel"),l=this.target.val().split(","),s=[];$.each(l,function(t,e){e!==i&&s.push(e)}),this.target.val(s.join(","));var a=t.parent();a.fadeOut(250,function(){a.remove()}),1===e.thumbs.children(".thumbnail").length&&e.thumbs.fadeOut(250)};var toCall;if(void 0==(toCall=eval("this."+method))){if(this.ready)return;this.configure.apply(this,pluginArgs)}else toCall.apply(this,Array.prototype.slice.call(pluginArgs,1))})}}(jQuery);