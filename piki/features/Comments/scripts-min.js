!function($){var t=function(){return{$form:!1,$content:!1,$list:!1,$fields:!1,$status:!1,$footer:!1,$button:!1,main:function(){$(function(){t.init()})},init:function(){this.$content=$("#main-content"),this.$form=$("#commentform"),this.$form.length&&(this.$list=$("#comments-list"),this.$status=this.statusBox(),this.bindForm()),this.$content.length&&(this.$content.on("click","a.edit-comment-button",function(e){e.preventDefault();var i=$(this),s=i.parents(".comment-item").first();s.is(".editing")?t.doEdit(s,i):t.makeEditable(s,i)}),this.$content.on("click","a.remove-comment-button",function(e){e.preventDefault();var i=$(this),s=i.parents(".comment-item").first();t.doDelete(s,i)}))},bindForm:function(){this.$fields=$("input, textarea, selecet",this.$form),this.$form.attr("action",Piki.blogurl+"/envia-comentario/"),this.$form.on("submit",function(e){e.preventDefault(),t.submit()})},submit:function(){this.$fields.removeClass("error");var e=$.ajax({url:this.$form.attr("action"),type:"POST",dataType:"JSON",data:this.$form.serialize(),beforeSend:function(){$.fn.pikiLoader(),t.removeErrors()}});e.done(function(e){$.fn.pikiLoader("close"),"error"==e.status?t.setError(e):(t.insertComment(e.comment),t.setSuccess())}),e.fail(function(t,e){console.log("Request failed: "+e)})},doEdit:function(e,i){var s=$.ajax({url:i.attr("href"),type:"POST",dataType:"JSON",data:{comment_ID:i.attr("rel"),comment:e.find(".content-edit-field textarea").val(),editing:!0},beforeSend:function(){$.fn.pikiLoader(),PikiComm_remove_erro(e)}});s.done(function(i){$.fn.pikiLoader("close"),"error"==i.status?t.serError(e,i):t.editSuccess(e,i)}),s.fail(function(t,e){console.log("Request failed: "+e)})},doDelete:function(e,i){$.fn.pikiLoader();var s=$.ajax({url:i.attr("href"),type:"POST",dataType:"JSON",data:{comment_ID:i.attr("rel")}});s.done(function(i){$.fn.pikiLoader("close"),"error"==i.status?t.setError(e,i):e.slideUp(300,function(){$(this).remove()})}),s.fail(function(t,e){console.log("Request failed: "+e)})},insertComment:function(t){$(t).hide().prependTo(this.$list).slideDown("medium")},removeErrors:function(){this.$fields.removeClass("error"),this.$status.fadeOut()},setError:function(t){this.$fields.filter("#"+t.field).addClass("error"),this.setStatus("error",t.message)},setSuccess:function(){this.$form.reset();var t=this.$form.is(".comment-item")?"edited":"sibmited";this.setStatus("success","Your comment has been "+t+" successfully")},setStatus:function(t,e){this.$status.removeClass("error success alert").addClass(t).stop(!0,!0).hide().html(e).fadeIn("medium")},makeEditable:function(t,e){if(e.text("Salvar"),!t.is(".editing")){t.addClass("editing");var i=$(".comment-content",t),s=$(".content-edit-field",t);s.length||(s=$('<div class="content-edit-field"><textarea id="contnet-'+t.attr("id")+'">'+i.text()+"</textarea></div>").insertAfter(i).hide()),i.slideUp(300),s.slideDown(450)}},editSuccess:function(t,e){t.removeClass("editing"),window.PikiComm_remove_erro(t),$(".comment-content",t).html(e.comment).slideDown(450),$(".content-edit-field",t).slideUp(300),$(".pikilike-box",t).fadeIn(),$(".edit-comment-button",t).text("Editar")},statusBox:function(){return!1!==this.$status?this.$status:(this.$status=$('<div class="status"></div>').hide(),this.$button=$("#submit",this.$form),this.$footer=$(".comment-footer",this.$form),this.$footer.length?this.$status.appendTo($footer):this.$status.insertAfter(this.$button),this.$status)}}}();t.main()}(jQuery);