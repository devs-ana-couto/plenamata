!function($){function custom_radios_actualize_item(e){var i=e.attr("name"),t=$('input[name="'+i+'"]');t.parent(".j-custom-radio").removeClass("checked"),t.filter(":checked").length>0&&e.parent(".j-custom-radio").addClass("checked")}$.fn.pikiSelect=function(method){var pluginArgs=arguments;return this.each(function(){var field=this,$this=$(this);this.configure=function(){this.last_value=$this.val(),this.wrapper=$('<div class="j-custom-select-holder clearfix" />').attr("tabindex",1).insertBefore($this),this.wrapper.addClass($this.attr("class")),$this.appendTo(this.wrapper),this.fidex_size=void 0!=$this.attr("fixed-size"),this.autosize=!1!==$this.data("autosize"),this.items=$this.find("option"),this.label=$('<span class="text" />').appendTo(this.wrapper),this.picker=$('<span class="picker" />').appendTo(this.wrapper),this.picker_width=parseInt(this.picker.outerWidth()),$this.prop("disabled")&&this.wrapper.addClass("disabled"),$this.on("focus",function(){$(document).on("keyup",function(e){field.selectEvent(e)})}),$this.on("focusout",function(){$(document).off("keyup",function(e){field.selectEvent(e)})}),$this.on("change",function(){field.onChange()}),this.on("actualize",function(){fiele.actualizeLabel()}),this.resize(),this.actualizeLabel(),this.ready=!0},this.onChange=function(){this.last_value=$this.val(),field.actualizeLabel()},this.actualizeLabel=function(){this.selected=$this.find('option[value="'+$this.val()+'"]'),this.labelText=this.selected.length?this.selected.html():this.items.first().html(),this.label.html(this.labelText)},this.resize=function(){var e,i=0;if(this.fidex_size)e=this.fidex_size-this.picker.outerWidth();else{var t=this.wrapper.clone().css({position:"absolute",top:0,left:0,visibility:"hidden",display:"block",width:"100%"}).appendTo(_body),s=t.find(".text").first().css({width:"auto",display:"table"}),a=t.find("select").first();e=0,a.children("option").each(function(){s.html($(this).html()),s.outerWidth()>e&&(e=s.outerWidth())}),a.remove()}if($.browser.msie&&$.browser.version<8){var n=parseInt(this.label.css("padding-left")),o=parseInt(this.label.css("padding-right")),r=parseInt(this.label.css("border-left-width")),l=parseInt(this.label.css("border-right-width"));e-=n+o,i+=n+o+r+l}var d=e+this.picker_width+i;this.label.css({width:e+"px",display:"block"}),this.wrapper.css("width",d+"px"),$this.css("width",d+"px")},this.setValue=function(e){$this.val(e).change()},this.selectEvent=function(e){e.keyCode>=37&&e.keyCode<=40&&$this.val()!=this.last_value&&$this.change()},this.disable=function(){$this.prop("disabled","disabled"),this.wrapper.addClass("disabled")},this.enable=function(){$this.prop("disabled",!1),this.wrapper.removeClass("disabled")},this.populate=function(e,i){void 0!=i&&1==i?$this.find("option").first().siblings().remove():$this.find("option").remove(),$.each(e,function(e,i){$this.append('<option value="'+e+'">'+i+"</option>")}),this.resize()},this.removeItems=function(){this.disable(),$this.find("option").first().siblings().remove(),this.setValue($this.find("option").first().val()),this.enable()};var toCall;void 0==(toCall=eval("this."+method))&&void 0==this.ready?this.configure.apply(this,pluginArgs):toCall.apply(this,Array.prototype.slice.call(pluginArgs,1))})},$.fn.pikiCheckbox=function(method){var pluginArgs=arguments;return this.each(function(){var field=this,$this=$(this);if("checkbox"===$this.attr("type")){this.configure=function(){if(!0!==this.ready){this.init_value=$this.prop("checked"),this.wrapper=$('<div class="j-custom-checkbox"></div>').insertBefore($this);var e=$this.attr("piki-check-background");void 0!=e&&this.wrapper.css("background-image","url("+e+")"),$this.appendTo(this.wrapper),this.actualize(),$this.on("focus",function(){field.wrapper.addClass("focus"),$this.parents("label").first().addClass("focus")}),$this.on("focusout",function(){field.wrapper.removeClass("focus"),$this.parents("label").first().removeClass("focus")}),$this.change(function(){!0===$this.prop("checked")?(field.wrapper.addClass("checked"),$this.parents("label").first().addClass("checked")):(field.wrapper.removeClass("checked"),$this.parents("label").first().removeClass("checked"))});var i=$this.parents("form").first();i.length&&i.bind("reset",function(){field.reset()}),this.ready=!0}},this.actualize=function(){!0===$this.prop("checked")||"checked"===$this.prop("checked")?this.wrapper.addClass("checked").parent().addClass("checked"):this.wrapper.removeClass("checked").parent().removeClass("checked")},this.reset=function(){!0===this.init_value?$this.prop("checked",!0):$this.prop("checked",!1),this.actualize()};var toCall;void 0==(toCall=eval("this."+method))&&void 0==this.ready?this.configure.apply(this,pluginArgs):toCall.apply(this,Array.prototype.slice.call(pluginArgs,1))}})},window.init_custom_checkboxes=function(e,i){jselect=void 0==e?"input:checkbox":e+" input:checkbox";var t=$(jselect);t.length&&(t.pikiCheckbox(),void 0!=i&&i(t))},window.init_custom_radios=function(e,i){jselect=void 0==e?"input:radio":e+" input:radio",$(jselect).not(".ready").each(function(){var e=$(this),i=e.prop("checked")?" checked":"",t=$('<div class="j-custom-radio"></div>').addClass(i).insertBefore(e);e.appendTo(t),e.on("focus",function(){$(this).parent().addClass("focus")}),e.on("focusout",function(){$(this).parent().removeClass("focus")}),e.addClass("ready").data("PikiRadio",{terget:e,wrapper:t}),e.change(function(){custom_radios_actualize_item($(this))})}).addClass("ready")},window.init_custom_filefields=function(){jQuery("input:file").not(".ready").each(function(){jQuery(this).wrap('<div class="j-custom-filefield-holder"></div>')}).addClass("ready")},window.init_image_fields=function(){var e=$("#form-denuncia");$("input.denuncia-photo").change(function(){var i=jQuery(this);if(""!=i.val())return e.find("#action-name").val("image-upload"),e.find("#action-target").val(i.attr("rel")),$.fn.pikiLoader("all"),e.submit(),!1}),$("a.remove-photo-button").live("click",function(e){e.preventDefault(),confir_image_delete(jQuery(this))}),$("div.col.photo div.confirm-box .no").live("click",function(){$(this).parent().hide()}),$("div.col.photo div.confirm-box .yes").live("click",function(){var e={target:jQuery(this).parent().parent(".field").find("input:file").attr("id")};image_field_change_state("clear",e)})},window.confir_image_delete=function(e){var i=e.parents(".field"),t=i.find(".confirm-box");t.length||((t=jQuery('<div class="confirm-box"></div>')).html("<span>"+_t("delete_photo").toUpperCase()+'?</span><a class="no">'+_t("no").toUpperCase()+'</a><a class="yes">'+_t("yes").toUpperCase()+"</a>"),t.appendTo(i),t.hide()),t.show()},window.image_field_change_state=function(e,i){var t=$("#"+i.target),s=$("#"+i.target+"-uri"),a=$("#"+i.target+"-thumb-uri"),n=t.parent().parent(".field");if("clear"==e)$.ajax({type:"POST",url:blog_url+"?api=true&action=image-delete",dataType:"JSON",data:"image_uri="+s.val()+"&thumb_uri="+a.val(),beforeSend:function(e){e.overrideMimeType("text/plain; charset=utf-8"),$.fn.pikiLoader("all")}}).done(function(e){$.fn.pikiLoader("close"),"error"==e.status?openAlert({content:e.message,status:e.status}):image_field_change_state("reset",i)}),clear_file_field(t);else if("reset"==e)n.find("div.thumbnail").remove(),n.find("div.confirm-box").remove(),s.val(""),clear_file_field(t);else{var o=$('<div class="thumbnail"></div>');o.append('<img src="'+i.thumbnail.url+'" />'),o.append('<a class="remove-photo-button" title="'+_t("delete_photo")+'">'+_t("delete_photo")+"</a>"),o.appendTo(n),n.find("input#"+i.target+"-uri").val(i.fullsize.uri),n.find("input#"+i.target+"-thumb-uri").val(i.thumbnail.uri)}},window.reset_photo_field=function(e){var i=$("#"+e),t=i.parent().parent(".field"),s=$("#"+e+"-uri");t.find("div.thumbnail").remove(),t.find("div.confirm-box").remove(),s.val(""),clear_file_field(i)},window.clear_photo_fields=function(){$("fieldset#photos div.col.photo input:file").each(function(){clear_file_field($(this))})},window.init_avatar_fields=function(){$(".ftype-avatar").not(".ready").each(function(){var e=$(this),i=e.find(".widget"),t=e.find("select");i.children(".options").find('[rel="'+t.val()+'"]').addClass("selected");i.children(".arrow.left").click(function(){avatar_field_change($(this))}),i.children(".arrow.right").click(function(){avatar_field_change($(this))})})},window.avatar_field_change=function(e){var i=e.is(".left")?"prev":"next",t=e.parents(".field-item").first(),s=t.find(".widget .options"),a=s.find("img.selected"),n="next"==i?a.next():a.prev();n.length||(n="next"==i?s.find("img").first():s.find("img").last()),a.removeClass("selected"),n.addClass("selected"),pikiSelectVal(t.find("select"),n.attr("rel")),console.log("$clicked:"),console.log(n)}}(jQuery);