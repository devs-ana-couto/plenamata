{"version":3,"file":"capas.js","sources":["capas.js"],"sourcesContent":["var Capas;\n\n(function($){\n\n\tCapas = {\n\n\t\t$ : null,\n\t\t$switcher : null,\n\t\t$form : null,\n\t\t$content : null,\n\t\tscrollOffset : null,\n\t\tpost_id : null,\n\t\tactualType : null,\n\n\t\tinit : function(){\n\n\t\t\tthis.$ = $( '#asn-capa-builder' );\n\t\t\tif( !this.$.length ) return true;\n\n\t\t\t// Form and post id\n\t\t\tthis.$form = $( 'form#post' );\n\t\t\tthis.post_id = $( 'input#post_ID', this.$form ).val();\n\n\t\t\t// Content object\n\t\t\tthis.$content = $( '#sticky-content', this.$ );\n\t\t\tthis.$content.on( 'click', 'a', function(e){\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t\t\n\t\t\t// Scroll offset\n\t\t\tthis.scrollOffset = $( '#wpadminbar' ).outerHeight();\n\n\t\t\t// Template switcher\n\t\t\tthis.$switcher = $( 'select#template', this.$ );\n\t\t\tthis.$switcher.on( 'change', function(){\n\t\t\t\tCapas.requestCapa( this.value );\n\t\t\t});\t\n\n\t\t\t// Bind capas fields\n\t\t\tthis.bindCapa();\n\n\t\t},\n\n\t\trequestCapa : function( type ){\n\n\t\t\tLoader();\n\n\t\t\tvar data = {\n\t\t\t\taction : 'capas_get_capa',\n\t\t\t\tpost_id : Capas.post_id,\n\t\t\t\ttemplate : type\n\t\t\t};\n\n\t\t\t$.ajax({\n\t\t\t\turl : Piki.ajaxurl,\n\t\t\t\ttype : 'POST',\n\t\t\t\tdata : data\n\t\t\t})\n\t\t\t.done(function(response){\n\n\t\t\t\tLoader( 'close' );\n\n\t\t\t\tCapas.$content\n\t\t\t\t\t.fadeOut( 300 )\n\t\t\t\t\t.html( response )\n\t\t\t\t\t.fadeIn(function(){\n\n\t\t\t\t\t\t// Bind capas fields\n\t\t\t\t\t\tCapas.bindCapa();\n\n\t\t\t\t\t\t// Scrolling\n\t\t\t\t\t\twindow.scroll({\n\t\t\t\t\t\t\ttop: ( Capas.$.offset().top - Capas.scrollOffset ),\n\t\t\t\t\t\t\tbehavior: 'smooth'\n\t\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t\t\n\t\t\t})\n\t\t\t.fail(function( error ){\n\t\t\t\tLoader( 'close' );\n\t\t\t\tMessage.open( error.responseText );\n\t\t\t});\n\n\t\t},\n\n\t\tbindCapa : function(){\n\t\t\tthis.$.on( 'select', 'button[data-action=\"post-select-open\"]', function( e, data ){\n\t\t\t\tCapas.getTeaser( data );\n\t\t\t});\n\t\t},\n\n\t\tgetTeaser : function( data ){\n\n\t\t\tLoader();\n\n\t\t\tvar parameters = {\n\t\t\t\taction : 'capas_get_teaser',\n\t\t\t\tparent_id : Capas.post_id,\n\t\t\t\tpost_id : data.$target.val(),\n\t\t\t\ttemplate : data.template,\n\t\t\t\tgroup : data.group\n\t\t\t};\n\n\t\t\t$.ajax({\n\t\t\t\turl : Piki.ajaxurl,\n\t\t\t\ttype : 'POST',\n\t\t\t\tdata : parameters\n\t\t\t})\n\t\t\t.done(function(response){\n\n\t\t\t\tLoader( 'close' );\n\n\t\t\t\t$parent = data.$.parent();\n\n\t\t\t\t$html = $( response ).insertAfter( $parent );\n\t\t\t\t$parent.remove();\n\n\t\t\t})\n\t\t\t.fail(function( error ){\n\t\t\t\tLoader( 'close' );\n\t\t\t\tMessage.open( error.responseText );\n\t\t\t});\n\t\t\t\n\t\t}\n\n\t};\n\t$(function(){\n\t\tCapas.init();\n\t});\n\n})(jQuery);"],"names":["Capas","$","$switcher","$form","$content","scrollOffset","post_id","actualType","init","this","length","val","on","e","preventDefault","outerHeight","requestCapa","value","bindCapa","type","Loader","data","action","template","ajax","url","Piki","ajaxurl","done","response","fadeOut","html","fadeIn","window","scroll","top","offset","behavior","fail","error","Message","open","responseText","getTeaser","parameters","parent_id","$target","group","$parent","parent","$html","insertAfter","remove","jQuery"],"mappings":"AAAA,IAAIA,OAEJ,SAAUC,GAETD,MAAQ,CAEPC,EAAI,KACJC,UAAY,KACZC,MAAQ,KACRC,SAAW,KACXC,aAAe,KACfC,QAAU,KACVC,WAAa,KAEbC,KAAO,WAGN,GADAC,KAAKR,EAAIA,EAAG,sBACPQ,KAAKR,EAAES,OAAS,OAAO,EAG5BD,KAAKN,MAAQF,EAAG,aAChBQ,KAAKH,QAAUL,EAAG,gBAAiBQ,KAAKN,OAAQQ,MAGhDF,KAAKL,SAAWH,EAAG,kBAAmBQ,KAAKR,GAC3CQ,KAAKL,SAASQ,GAAI,QAAS,IAAK,SAASC,GACxCA,EAAEC,mBAIHL,KAAKJ,aAAeJ,EAAG,eAAgBc,cAGvCN,KAAKP,UAAYD,EAAG,kBAAmBQ,KAAKR,GAC5CQ,KAAKP,UAAUU,GAAI,SAAU,WAC5BZ,MAAMgB,YAAaP,KAAKQ,SAIzBR,KAAKS,YAINF,YAAc,SAAUG,GAEvBC,SAEIC,EAAO,CACVC,OAAS,iBACThB,QAAUN,MAAMM,QAChBiB,SAAWJ,GAGZlB,EAAEuB,KAAK,CACNC,IAAMC,KAAKC,QACXR,KAAO,OACPE,KAAOA,IAEPO,KAAK,SAASC,GAEdT,OAAQ,SAERpB,MAAMI,SACJ0B,QAAS,KACTC,KAAMF,GACNG,OAAO,WAGPhC,MAAMkB,WAGNe,OAAOC,OAAO,CACbC,IAAOnC,MAAMC,EAAEmC,SAASD,IAAMnC,MAAMK,aACpCgC,SAAU,eAObC,KAAK,SAAUC,GACfnB,OAAQ,SACRoB,QAAQC,KAAMF,EAAMG,iBAKtBxB,SAAW,WACVT,KAAKR,EAAEW,GAAI,SAAU,yCAA0C,SAAUC,EAAGQ,GAC3ErB,MAAM2C,UAAWtB,MAInBsB,UAAY,SAAUtB,GAErBD,SAEA,IAAIwB,EAAa,CAChBtB,OAAS,mBACTuB,UAAY7C,MAAMM,QAClBA,QAAUe,EAAKyB,QAAQnC,MACvBY,SAAWF,EAAKE,SAChBwB,MAAQ1B,EAAK0B,OAGd9C,EAAEuB,KAAK,CACNC,IAAMC,KAAKC,QACXR,KAAO,OACPE,KAAOuB,IAEPhB,KAAK,SAASC,GAEdT,OAAQ,SAER4B,QAAU3B,EAAKpB,EAAEgD,SAEjBC,MAAQjD,EAAG4B,GAAWsB,YAAaH,SACnCA,QAAQI,WAGRd,KAAK,SAAUC,GACfnB,OAAQ,SACRoB,QAAQC,KAAMF,EAAMG,kBAMvBzC,EAAE,WACDD,MAAMQ,SA/HR,CAkIG6C"}